#!/bin/sh

{% set devs = (NumberofLANclients | int *DevsPercentage | int *0.01)|int %}
{% set admins = (NumberofLANclients | int *AdminPercentage | int *0.01)|int %}
{% set ops = (NumberofLANclients | int *OpsPercentage | int *0.01)|int %}



# Functions to run Cronjobs on Departments - Assign distribution 0-1
# These Cronjobs run the actual traffic generation scripts as defined in Cronjobs.sh.j2
developers () {
   dep="developers"
   web=0.8
   smb=0.3
   vpn=0.2

   # Run Cronjob and pass assigned weights
   {% for i in range(1, devs | int +1) %}
   docker exec -d clab-{{networkname}}-Client{{i}}-DEVS-LAN chmod +x /Cronjobs.sh
   docker exec -d clab-{{networkname}}-Client{{i}}-DEVS-LAN bash /Cronjobs.sh $dep $web $smb $vpn
   {% endfor %}
}

admins () {
   dep="administration"
   web=0.2
   smb=0.6
   vpn=0.3

   {% for i in range(1, admins | int +1) %}
   docker exec -d clab-{{networkname}}-Client{{i}}-ADMINS-LAN chmod +x /Cronjobs.sh
   docker exec -d clab-{{networkname}}-Client{{i}}-ADMINS-LAN bash /Cronjobs.sh $dep $web $smb $vpn
   {% endfor %}
}

operations () {
   dep="operations"
   web=0.4
   smb=0.2
   vpn=0.1

   {% for i in range(1, ops | int +1) %}
   docker exec -d clab-{{networkname}}-Client{{i}}-OPS-LAN chmod +x /Cronjobs.sh
   docker exec -d clab-{{networkname}}-Client{{i}}-OPS-LAN bash /Cronjobs.sh $dep $web $smb $vpn
   {% endfor %}
}

developers

admins

operations